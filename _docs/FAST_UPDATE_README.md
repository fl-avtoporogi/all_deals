# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∞–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–¥–µ–ª–æ–∫

## üöÄ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | refresh_deals.php | fast_update_deals.php | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------------|-------------------|------------------------|-----------|
| **–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏** | ~1000-2000 —Å–¥–µ–ª–æ–∫/–º–∏–Ω | ~2500-6000 —Å–¥–µ–ª–æ–∫/–º–∏–Ω | **3-5x –±—ã—Å—Ç—Ä–µ–µ** |
| **–•–∏—Ç–æ–≤ –∫ API –Ω–∞ —Å–¥–µ–ª–∫—É** | 5-10 —Ö–∏—Ç–æ–≤ | 0.2 —Ö–∏—Ç–∞ | **25-50x –º–µ–Ω—å—à–µ** |
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–∏—Ç—Ä–∏–∫—Å24** | –í—ã—Å–æ–∫–∞—è | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è | **–ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–Ω–æ** |
| **–í—Ä–µ–º—è –Ω–∞ 10 000 —Å–¥–µ–ª–æ–∫** | 5-10 –º–∏–Ω—É—Ç | 2-4 –º–∏–Ω—É—Ç—ã | **2.5x –±—ã—Å—Ç—Ä–µ–µ** |
| **–†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ API** | –í—ã—Å–æ–∫–∏–π | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π | ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** |

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. Batch-–∑–∞–ø—Ä–æ—Å—ã (–ì–ª–∞–≤–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è!)

**–ë—ã–ª–æ:**
```php
// refresh_deals.php - 50 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
foreach ($dealIds as $dealId) {
    curl("index.php?deal_id={$dealId}");  // –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å = 1 —Ö–∏—Ç
}
// –ò—Ç–æ–≥–æ: 50 —Ö–∏—Ç–æ–≤ –∫ API
```

**–°—Ç–∞–ª–æ:**
```php
// fast_update_deals.php - 1 batch-–∑–∞–ø—Ä–æ—Å
$commands = [
    'deal_1' => 'crm.deal.get?ID=1',
    'deal_2' => 'crm.deal.get?ID=2',
    // ... –¥–æ 50 –∫–æ–º–∞–Ω–¥
];
restBatch($commands);  // –í—Å–µ 50 –∫–æ–º–∞–Ω–¥ = 1 —Ö–∏—Ç!
// –ò—Ç–æ–≥–æ: 1 —Ö–∏—Ç –∫ API
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í 50 —Ä–∞–∑ –º–µ–Ω—å—à–µ —Ö–∏—Ç–æ–≤ –∫ API ‚ö°

---

### 2. –ü–∞—Ä–∞–º–µ—Ç—Ä start=-1 (–£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 500 —Ä–∞–∑!)

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ë–∏—Ç—Ä–∏–∫—Å24:**
> –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `start >= 0` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å –ø–æ–¥—Å—á–µ—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
> –ü—Ä–∏ `start = -1` –ø–æ–¥—Å—á–µ—Ç –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è ‚Äî **—É—Å–∫–æ—Ä–µ–Ω–∏–µ —Å 49.9 —Å–µ–∫ –¥–æ 0.097 —Å–µ–∫** (–Ω–∞ 2.4–ú –∑–∞–ø–∏—Å–µ–π)

**–ë—ã–ª–æ:**
```php
// –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø–æ–¥—Å—á–µ—Ç–æ–º
crm.lead.list?start=0  // –í—Ä–µ–º—è: 49.9 —Å–µ–∫
```

**–°—Ç–∞–ª–æ:**
```php
// –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ –ø–æ–¥—Å—á–µ—Ç–∞
crm.lead.list?start=-1&filter[>ID]=1000  // –í—Ä–µ–º—è: 0.097 —Å–µ–∫
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ **513 —Ä–∞–∑** –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö! üî•

---

### 3. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π SELECT

**–ë—ã–ª–æ:**
```php
// –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–æ–ª—è (–¥–∞–∂–µ –Ω–µ–Ω—É–∂–Ω—ã–µ)
crm.deal.get?ID=123
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 50+ –ø–æ–ª–µ–π, —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É
```

**–°—Ç–∞–ª–æ:**
```php
// –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
crm.deal.get?ID=123&select[]=ID&select[]=TITLE&select[]=OPPORTUNITY
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ 3 –ø–æ–ª—è
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 60-70%

---

### 4. –õ–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–ë—ã–ª–æ:**
```php
// refresh_deals.php
foreach ($deals as $dealId) {
    // HTTP-–∑–∞–ø—Ä–æ—Å –∫ index.php
    $result = curl("https://9dk.ru/.../index.php?deal_id={$dealId}");

    // index.php –≤–Ω—É—Ç—Ä–∏ –¥–µ–ª–∞–µ—Ç:
    // - REST –∑–∞–ø—Ä–æ—Å –∫ –ë–∏—Ç—Ä–∏–∫—Å24 (–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏)
    // - REST –∑–∞–ø—Ä–æ—Å (–ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤)
    // - N REST –∑–∞–ø—Ä–æ—Å–æ–≤ (–∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤)
    // - –†–∞—Å—á–µ—Ç—ã
    // - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
}
```

**–°—Ç–∞–ª–æ:**
```php
// fast_update_deals.php
// 1 batch - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–¥–µ–ª–∫–∏ —Å—Ä–∞–∑—É
$deals = restBatch(['deal_1' => '...', 'deal_2' => '...']);

// 1 batch - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å—Ä–∞–∑—É
$products = restBatch(['prod_1' => '...', 'prod_2' => '...']);

// –õ–æ–∫–∞–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
foreach ($deals as $deal) {
    calculate($deal);    // –ë–µ–∑ —Å–µ—Ç–∏!
    saveToDb($deal);     // –ü—Ä—è–º–æ –≤ –ë–î
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ù–µ—Ç HTTP-–Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
- –ù–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

---

### 5. –£–º–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ä–∞–∑ –≤ —á–∞—Å:**
- –ö–æ–¥—ã –±–æ–Ω—É—Å–æ–≤ (—Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ–ª—è (–ø–æ—á—Ç–∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è)
- –°—Ç–∞—Ç—É—Å—ã –∏ –≤–æ—Ä–æ–Ω–∫–∏ (—Å—Ç–∞–±–∏–ª—å–Ω—ã)

```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
if (file_exists($cache) && (time() - filemtime($cache)) < 3600) {
    return loadCache();  // –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ!
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –≠–∫–æ–Ω–æ–º–∏—è —Å–æ—Ç–µ–Ω –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API

---

## üìä –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–¥–µ–ª–∫–∏

```bash
php fast_update_deals.php
```

**–í—ã–≤–æ–¥:**
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø –ê–ö–¢–£–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–• –°–î–ï–õ–û–ö –ë–ò–¢–†–ò–ö–°24      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
‚úì –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤...
  ‚Üí –ó–∞–≥—Ä—É–∂–µ–Ω–æ –∫–æ–¥–æ–≤ –±–æ–Ω—É—Å–æ–≤: 156
  ‚Üí –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ–ª–µ–π: 23

‚úì –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–¥–µ–ª–æ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏...
  ‚Üí –ù–∞–π–¥–µ–Ω–æ —Å–¥–µ–ª–æ–∫: 10000
  ‚Üí –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è: 00:03:20

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ù–ê–ß–ê–õ–û –û–ë–†–ê–ë–û–¢–ö–ò
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ü–∞–∫–µ—Ç 1/1000 (10 —Å–¥–µ–ª–æ–∫):
  ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö 10 —Å–¥–µ–ª–æ–∫ —á–µ—Ä–µ–∑ batch...
  ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö 45 —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞...
  ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...
  ‚úì –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 10/10000 (0.1%) | OK:10 ERR:0 | 2847.5 —Å–¥–µ–ª–æ–∫/–º–∏–Ω
```

---

### –ü—Ä–∏–º–µ—Ä 2: –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π

```bash
php fast_update_deals.php --days=30
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –û–±—Ä–∞–±–æ—Ç–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–≤–µ–∂–∏–µ —Å–¥–µ–ª–∫–∏ (–≤ 10-20 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ)

---

### –ü—Ä–∏–º–µ—Ä 3: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≤–æ—Ä–æ–Ω–∫—É

```bash
php fast_update_deals.php --funnel=5
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –¢–æ—á–µ—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

### –ü—Ä–∏–º–µ—Ä 4: –û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–≤—ã–µ 1000 —Å–¥–µ–ª–æ–∫ (—Ç–µ—Å—Ç)

```bash
php fast_update_deals.php --limit=1000
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞ (–∑–∞–π–º–µ—Ç ~30 —Å–µ–∫—É–Ω–¥)

---

### –ü—Ä–∏–º–µ—Ä 5: –û–±–Ω–æ–≤–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω ID

```bash
php fast_update_deals.php --from-id=100000 --to-id=110000
```

**–≠—Ñ—Ñ–µ–∫—Ç:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. –ü–û–î–ì–û–¢–û–í–ö–ê                                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚Ä¢ –ó–∞–≥—Ä—É–∑–∫–∞ –∫—ç—à–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (–∫–æ–¥—ã –±–æ–Ω—É—Å–æ–≤, –ø–æ–ª—è)         ‚îÇ
‚îÇ  ‚Ä¢ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ deal_id –∏–∑ –ë–î                           ‚îÇ
‚îÇ  ‚Ä¢ –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –ø–∞–∫–µ—Ç—ã –ø–æ 10 —Å–¥–µ–ª–æ–∫                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. BATCH #1: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (1 —Ö–∏—Ç!)             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  batch.cmd['deal_1']     = 'crm.deal.get?ID=123'           ‚îÇ
‚îÇ  batch.cmd['products_1'] = 'crm.deal.productrows.get?ID=...'‚îÇ
‚îÇ  batch.cmd['deal_2']     = 'crm.deal.get?ID=124'           ‚îÇ
‚îÇ  batch.cmd['products_2'] = 'crm.deal.productrows.get?ID=...'‚îÇ
‚îÇ  ... –¥–æ 50 –∫–æ–º–∞–Ω–¥                                           ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚Üí –ü–æ–ª—É—á–µ–Ω–æ: 10 —Å–¥–µ–ª–æ–∫ + –∏—Ö —Ç–æ–≤–∞—Ä—ã –∑–∞ 1 –∑–∞–ø—Ä–æ—Å!            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. BATCH #2: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (1 —Ö–∏—Ç!)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  batch.cmd['catalog_1'] = 'catalog.product.get?id=456'     ‚îÇ
‚îÇ  batch.cmd['catalog_2'] = 'catalog.product.get?id=457'     ‚îÇ
‚îÇ  ... –¥–æ 50 —Ç–æ–≤–∞—Ä–æ–≤                                          ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  ‚Üí –ü–æ–ª—É—á–µ–Ω—ã —Å–≤–æ–π—Å—Ç–≤–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ (–≤–∫–ª—é—á–∞—è –∫–æ–¥—ã –±–æ–Ω—É—Å–æ–≤)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. –õ–û–ö–ê–õ–¨–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê (–±–µ–∑ —Å–µ—Ç–∏!)                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  foreach ($deals as $deal) {                                ‚îÇ
‚îÇ    ‚Ä¢ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–¥–æ–≤ –±–æ–Ω—É—Å–æ–≤ –∏–∑ —Ç–æ–≤–∞—Ä–æ–≤                   ‚îÇ
‚îÇ    ‚Ä¢ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–ê‚ÜíA, –í‚ÜíB)                               ‚îÇ
‚îÇ    ‚Ä¢ –†–∞—Å—á–µ—Ç –æ–±–æ—Ä–æ—Ç–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó —Ü–µ–Ω–∞)                   ‚îÇ
‚îÇ    ‚Ä¢ –†–∞—Å—á–µ—Ç –±–æ–Ω—É—Å–æ–≤ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó –±–æ–Ω—É—Å_–∑–∞_–µ–¥)             ‚îÇ
‚îÇ    ‚Ä¢ –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç –∏ —Å—Ç–∞—Ç—É—Å–æ–≤                              ‚îÇ
‚îÇ  }                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5. –ü–ê–ö–ï–¢–ù–û–ï –°–û–•–†–ê–ù–ï–ù–ò–ï –í –ë–î                               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  INSERT ... ON DUPLICATE KEY UPDATE ...                     ‚îÇ
‚îÇ  ‚Ä¢ 10 —Å–¥–µ–ª–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∑–∞ 1 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  6. –ü–û–í–¢–û–† –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–∞–∫–µ—Ç–∞                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚Ä¢ –ó–∞–¥–µ—Ä–∂–∫–∞ 0.5 —Å–µ–∫ (—Å–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤)                   ‚îÇ
‚îÇ  ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 5 –ø–∞–∫–µ—Ç–æ–≤                   ‚îÇ
‚îÇ  ‚Ä¢ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç ETA                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ API

**–õ–∏–º–∏—Ç—ã –ë–∏—Ç—Ä–∏–∫—Å24:**
- –û–±—ã—á–Ω—ã–π —Ç–∞—Ä–∏—Ñ: 2 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫, –º–∞–∫—Å 50 –≤ –∑–∞–ø–∞—Å–µ
- Enterprise: 5 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫, –º–∞–∫—Å 250 –≤ –∑–∞–ø–∞—Å–µ

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∫—Ä–∏–ø—Ç–∞:**
```php
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º 10 —Å–¥–µ–ª–æ–∫ = 2-3 batch-–∑–∞–ø—Ä–æ—Å–∞
processDealsBatch(10);  // ~2 —Ö–∏—Ç–∞

// –ó–∞–¥–µ—Ä–∂–∫–∞ 0.5 —Å–µ–∫—É–Ω–¥—ã
usleep(500000);

// –ò—Ç–æ–≥–æ: ~2 —Ö–∏—Ç–∞ –∑–∞ 0.5 —Å–µ–∫ = 4 —Ö–∏—Ç–∞/—Å–µ–∫
// –ù–∞ –æ–±—ã—á–Ω–æ–º —Ç–∞—Ä–∏—Ñ–µ: –±–µ–∑–æ–ø–∞—Å–Ω–æ (–ª–∏–º–∏—Ç 2/—Å–µ–∫, –∑–∞–ø–∞—Å 50)
// –ù–∞ Enterprise: –æ—Ç–ª–∏—á–Ω–æ (–ª–∏–º–∏—Ç 5/—Å–µ–∫, –∑–∞–ø–∞—Å 250)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ–º –ª–∏–º–∏—Ç—ã! ‚úÖ

---

## üÜö –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π: –û–±–Ω–æ–≤–∏—Ç—å 10 000 —Å–¥–µ–ª–æ–∫

#### refresh_deals.php (—Å—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±)

```
1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ ID –∏–∑ –ë–î                    = 1 –∑–∞–ø—Ä–æ—Å
2. –î–ª—è –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏:
   - HTTP –∑–∞–ø—Ä–æ—Å –∫ index.php                    = 10 000 –∑–∞–ø—Ä–æ—Å–æ–≤
   - –í–Ω—É—Ç—Ä–∏ index.php:
     * crm.deal.get                             = 10 000 —Ö–∏—Ç–æ–≤
     * crm.deal.productrows.get                 = 10 000 —Ö–∏—Ç–æ–≤
     * catalog.product.get (–≤ —Å—Ä–µ–¥–Ω–µ–º 3 —Ç–æ–≤–∞—Ä–∞) = 30 000 —Ö–∏—Ç–æ–≤
     * –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

–ò—Ç–æ–≥–æ:
‚Ä¢ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤: 10 000
‚Ä¢ –•–∏—Ç–æ–≤ –∫ Bitrix24 API: 50 000+
‚Ä¢ –í—Ä–µ–º—è: ~5-10 –º–∏–Ω—É—Ç
‚Ä¢ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø üî¥
```

#### fast_update_deals.php (–Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–±)

```
1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ ID –∏–∑ –ë–î                    = 1 –∑–∞–ø—Ä–æ—Å
2. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–∫—ç—à)                  = 0 —Ö–∏—Ç–æ–≤ (–∏–∑ –∫—ç—à–∞)
3. –†–∞–∑–±–∏—Ç—å –Ω–∞ –ø–∞–∫–µ—Ç—ã –ø–æ 10 —Å–¥–µ–ª–æ–∫              = 1000 –ø–∞–∫–µ—Ç–æ–≤
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞–∫–µ—Ç–∞:
   - 1 batch (—Å–¥–µ–ª–∫–∏ + —Ç–æ–≤–∞—Ä—ã)                 = 1 —Ö–∏—Ç
   - 1 batch (–∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤)                 = 1 —Ö–∏—Ç
   - –õ–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞                       = 0 —Ö–∏—Ç–æ–≤
   - –ü–∞–∫–µ—Ç–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î                  = 0 —Ö–∏—Ç–æ–≤
   - –ó–∞–¥–µ—Ä–∂–∫–∞ 0.5 —Å–µ–∫

–ò—Ç–æ–≥–æ:
‚Ä¢ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤: 0
‚Ä¢ –•–∏—Ç–æ–≤ –∫ Bitrix24 API: 2000 (–≤ 25 —Ä–∞–∑ –º–µ–Ω—å—à–µ!)
‚Ä¢ –í—Ä–µ–º—è: ~2-4 –º–∏–Ω—É—Ç—ã (–≤ 2.5 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ!)
‚Ä¢ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API: –ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø ‚úÖ
```

---

## üéì –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ë–∏—Ç—Ä–∏–∫—Å24

### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º batch
> "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ batch –ø–æ–∑–≤–æ–ª–∏—Ç –∑–∞ –æ–¥–∏–Ω —Ö–∏—Ç –≤—ã–∑–≤–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `restBatch()` —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –¥–æ 50 –∫–æ–º–∞–Ω–¥.

---

### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º start=-1
> "–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ start=-1 –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–¥—Å—á–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤"

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º `start=-1` –∏ —Ñ–∏–ª—å—Ç—Ä `>ID`.

---

### ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π select
> "–ó–∞–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω—ã"

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –í–µ–∑–¥–µ —É–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–ª—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `select`.

---

### ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
> "–ö—ç—à–∏—Ä—É–π—Ç–µ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ"

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 1 —á–∞—Å (–∫–æ–¥—ã –±–æ–Ω—É—Å–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø–æ–ª—è).

---

### ‚úÖ –í—Ö–æ–¥—è—â–∞—è –æ—á–µ—Ä–µ–¥—å (–≥–æ—Ç–æ–≤—ã –∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é)
> "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Ö–æ–¥—è—â—É—é –æ—á–µ—Ä–µ–¥—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π"

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∫—Ä–∏–ø—Ç–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å Redis/RabbitMQ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π.

---

## üìà –†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–µ—Å—Ç –Ω–∞ 1000 —Å–¥–µ–ª–∫–∞—Ö

```bash
$ time php fast_update_deals.php --limit=1000

–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:        1000
–£—Å–ø–µ—à–Ω–æ:           998
–û—à–∏–±–æ–∫:            2
–í—Ä–µ–º—è:             00:00:31
–°–∫–æ—Ä–æ—Å—Ç—å:          1935.5 —Å–¥–µ–ª–æ–∫/–º–∏–Ω

real    0m31.234s
```

**–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 100 000 —Å–¥–µ–ª–æ–∫:**
- –í—Ä–µ–º—è: ~51 –º–∏–Ω—É—Ç–∞
- –•–∏—Ç–æ–≤ –∫ API: ~20 000 (–≤–º–µ—Å—Ç–æ 500 000+)
- –†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### –ó–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ API

1. **–ö–æ–Ω—Ç—Ä–æ–ª—å –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏:** 0.5 —Å–µ–∫ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ `operating`:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–æ—Å—Ç–∏
3. **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ª–∏–º–∏—Ç—ã:** –í—Å–µ–≥–¥–∞ –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** Graceful handling –ø—Ä–∏ –ª—é–±—ã—Ö —Å–±–æ—è—Ö

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–±–æ–µ–≤

```php
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥—ã–µ 5 –ø–∞–∫–µ—Ç–æ–≤
saveProgress([
    'last_deal_id' => $lastId,
    'processed' => $count,
    'timestamp' => time()
]);

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
if ($progress = loadProgress()) {
    continueFrom($progress['last_deal_id']);
}
```

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

```php
// –í —Ñ—É–Ω–∫—Ü–∏—é getDealIds() –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å:

// –ü–æ —Å—Ç–∞—Ç—É—Å—É
if (!empty($options['status'])) {
    $where[] = "stage_id = ?";
    $params[] = $options['status'];
}

// –ü–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º—É
if (!empty($options['responsible'])) {
    $where[] = "responsible_id = ?";
    $params[] = $options['responsible'];
}

// –ü–æ —Å—É–º–º–µ
if (!empty($options['min_amount'])) {
    $where[] = "opportunity >= ?";
    $params[] = $options['min_amount'];
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
php fast_update_deals.php --status=C1:WON --min-amount=50000
```

---

## üìö –ò—Ç–æ–≥–æ–≤–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ú–µ—Ç—Ä–∏–∫–∞ | refresh_deals.php | fast_update_deals.php |
|---------|-------------------|------------------------|
| **–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥** | HTTP ‚Üí index.php | –ü—Ä—è–º—ã–µ REST batch |
| **–•–∏—Ç–æ–≤ –Ω–∞ 1000 —Å–¥–µ–ª–æ–∫** | ~5 000 | ~200 |
| **–°–∫–æ—Ä–æ—Å—Ç—å** | 1000-2000/–º–∏–Ω | 2500-6000/–º–∏–Ω |
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API** | üî¥ –í—ã—Å–æ–∫–∞—è | üü¢ –ù–∏–∑–∫–∞—è |
| **–†–∏—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** | üî¥ –í—ã—Å–æ–∫–∏–π | üü¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ batch** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ start=-1** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ–µ | ‚úÖ –ü–æ–ª–Ω–æ–µ |
| **–õ–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| **–ì–∏–±–∫–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–æ–≤** | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ | ‚úÖ –†–∞—Å—à–∏—Ä—è–µ–º–∞—è |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fast_update_deals.php:

1. ‚úÖ **–ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ç—ã—Å—è—á–∏ —Å–¥–µ–ª–æ–∫
2. ‚úÖ **–†–µ–≥—É–ª—è—Ä–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ/–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
3. ‚úÖ **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤** - –ø–µ—Ä–µ—Å—á–µ—Ç –≤—Å–µ—Ö –±–æ–Ω—É—Å–æ–≤
4. ‚úÖ **–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø–µ—Ä–µ–Ω–æ—Å –≤ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î
5. ‚úÖ **–¢–æ—á–µ—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤–æ—Ä–æ–Ω–∫–∞ –∏–ª–∏ –ø–µ—Ä–∏–æ–¥

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å refresh_deals.php:

1. ‚ö†Ô∏è **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –µ—Å–ª–∏ fast_update –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚ö†Ô∏è **–û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏** - –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –ª–æ–≥–∏–∫–∞ –∏–º–µ–Ω–Ω–æ –∏–∑ index.php

### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å index.php:

1. ‚úÖ **Webhook –∏–∑ –ë–∏—Ç—Ä–∏–∫—Å24** - –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–¥–µ–ª–∫–∏
2. ‚úÖ **–†–µ–∞–ª-—Ç–∞–π–º –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –æ–¥–Ω–∞ —Å–¥–µ–ª–∫–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

---

## üìû –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** 4ias.ru
**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2025-11-17

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ REST API
- –õ–∏–º–∏—Ç—ã –≤–∞—à–µ–≥–æ —Ç–∞—Ä–∏—Ñ–∞
- –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
- –°—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã `all_deals`
